# Test Environment Configuration
# This file is for running automated tests
# Uses minimal resources and in-memory databases where possible

# ==============================================================================
# Environment
# ==============================================================================
NODE_ENV=test

# ==============================================================================
# Server Configuration
# ==============================================================================
PORT=3002

# ==============================================================================
# AI Provider Selection
# ==============================================================================
# For tests, use Ollama for consistency and no API costs
# Tests should mock AI responses where possible for speed

EMBEDDING_PROVIDER=ollama
LLM_PROVIDER=ollama

# ==============================================================================
# Ollama Configuration (Test Environment)
# ==============================================================================
# For tests, use Ollama with minimal settings
# If Ollama not available, tests should use mocks

OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_EMBEDDING_MODEL=nomic-embed-text
OLLAMA_EMBEDDING_DIMENSIONS=768
OLLAMA_LLM_MODEL=llama3
OLLAMA_MAX_TOKENS=500
OLLAMA_TEMPERATURE=0.0
OLLAMA_TIMEOUT=30000

# ==============================================================================
# OpenAI Configuration (Optional for Tests)
# ==============================================================================
# Only used if explicitly testing OpenAI integration
# Most tests should mock API responses instead

# OPENAI_KEY=sk-test-key
# OPENAI_EMBEDDING_MODEL=text-embedding-3-small
# OPENAI_EMBEDDING_DIMENSIONS=1536
# OPENAI_MODEL=gpt-3.5-turbo
# OPENAI_MAX_TOKENS=500
# OPENAI_TEMPERATURE=0.0

# ==============================================================================
# Avon Health API Configuration
# ==============================================================================
# Use mock/test credentials for testing
AVON_CLIENT_ID=test_client_id
AVON_CLIENT_SECRET=test_client_secret
AVON_BASE_URL=https://demo-api.avonhealth.com

# ==============================================================================
# Vector Database Configuration
# ==============================================================================
# Use in-memory for tests (fast, no persistence needed)
VECTOR_DB_TYPE=chromadb

# Test FAISS configuration (if needed for integration tests)
# VECTOR_DB_TYPE=faiss
# FAISS_INDEX_PATH=./test/data/faiss
# FAISS_DIMENSION=768
# PG_HOST=localhost
# PG_PORT=5432
# PG_DATABASE=avon_rag_test
# PG_USER=test
# PG_PASSWORD=test

# ==============================================================================
# Cache Configuration
# ==============================================================================
# Disable cache in tests for predictable results
CACHE_ENABLED=false
CACHE_TTL_SECONDS=0

# ==============================================================================
# Performance Configuration
# ==============================================================================
# Use smaller batches and fewer results for faster tests
MAX_EMBEDDING_BATCH_SIZE=10
RETRIEVAL_TOP_K=5

# ==============================================================================
# CORS Configuration
# ==============================================================================
CORS_ORIGIN=http://localhost:3000

# ==============================================================================
# Logging Configuration
# ==============================================================================
# Minimal logging in tests (only errors)
LOG_LEVEL=error

# ==============================================================================
# Rate Limiting
# ==============================================================================
# Disable rate limiting in tests
RATE_LIMIT_ENABLED=false
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=10000

# ==============================================================================
# Security
# ==============================================================================
HTTPS_REDIRECT=false
IP_WHITELIST=

# ==============================================================================
# Test Notes
# ==============================================================================
# MOCKING STRATEGY:
# - Unit tests: Mock all AI responses (no Ollama/OpenAI required)
# - Integration tests: Use Ollama if available, otherwise skip with warnings
# - E2E tests: Use Ollama with real models
#
# PERFORMANCE:
# - Keep OLLAMA_MAX_TOKENS low (500) for fast tests
# - Use smaller batch sizes (10) to reduce test time
# - Disable caching for predictable, isolated tests
#
# CI/CD:
# - Tests should pass without Ollama installed
# - Use mocks for AI providers in CI pipelines
# - Mark Ollama-dependent tests as @integration or @requires-ollama
